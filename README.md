# Digital twins for _in vivo_ metabolic flux estimation in brain cancer patients

The codes related to our manuscript **"Digital twins for _in vivo_ metabolic flux estimation in brain cancer patients"** can be found in this repository.

We organized the codes into following folders and provided a detailed description for using the codes in each folder. Please click on the links below to see the codes and README files.

1. [Single-cell RNA-seq analysis](https://github.com/baharm1/ML_MFA/blob/main/single_cell_analysis)

2. [Single-cell metabolic interaction analysis](https://github.com/baharm1/ML_MFA/blob/main/single_cell_metabolic_interaction_analysis)

<p align="center">
	<img width="60%" src="https://github.com/baharm1/ML_MFA/blob/main/readme_figs/metabolic_interaction.png">
</p>

3. [Modified scFEA: Quantification of exchange fluxes using scRNA-seq data](https://github.com/baharm1/ML_MFA/blob/main/modified_scFEA)

<p align="center">
	<img width="40%" src="https://github.com/baharm1/ML_MFA/blob/main/readme_figs/modified_scFEA.png">
</p>

4. [<sup>13</sup>C-scMFA: Quantification of intra- and intercellular fluxes using integrated scRNA-seq and <sup>13</sup>C-enrichment data](https://github.com/baharm1/ML_MFA/blob/main/13C_scMFA)

<p align="center">
	<img width="60%" src="https://github.com/baharm1/ML_MFA/blob/main/readme_figs/13C_scMFA.png">
</p>

5. [Development of patient digital twins: Simulation of fluxes and <sup>13</sup>C-enrichment data](https://github.com/baharm1/ML_MFA/blob/main/data_simulation)

<p align="center">
	<img width="100%" src="https://github.com/baharm1/ML_MFA/blob/main/readme_figs/data_simulation.png">
</p>

6. [Metabolic CNN: Estimation of relative anabolic fluxes in bulk tissues](https://github.com/baharm1/ML_MFA/blob/main/metabolic_CNN)

<p align="center">
	<img width="60%" src="https://github.com/baharm1/ML_MFA/blob/main/readme_figs/metabolic_CNN.png">
</p>

7. [Informed MFA: Metabolic flux analysis informed by CNN-predicted fluxes](https://github.com/baharm1/ML_MFA/blob/main/informed_MFA)

### Requirements:
1. MATLAB R2021b with default installation on Windows 11
2. [Artelys Knitro Optimizer version 12.4](https://www.artelys.com/solvers/knitro/) (MATLAB version)
3. MATLAB Parallel Processing toolkit (optional)
4. R version 4.2.2
5. Python version 3.8 and 3.11

More detailed requirements can be found in each folder.

## Citation
Meghdadi B. _et al._ Digital twins for _in vivo_ metabolic flux estimation in brain cancer patients. _Cell Metabolism_ (2025). 